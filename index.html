<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bowel and Bladder Function Diary</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #2c5aa0;
            margin: 0;
            font-size: 24px;
        }
        
        .header p {
            margin: 5px 0;
            color: #666;
        }
        
        .form-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .patient-info {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .patient-info input {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 12px;
        }
        
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
            vertical-align: middle;
        }
        
        th {
            background-color: #f0f0f0;
            font-weight: bold;
            font-size: 11px;
        }
        
        .time-col {
            width: 80px;
            background-color: #f9f9f9;
            font-weight: bold;
        }
        
        .food-col {
            width: 150px;
        }
        
        .elimination-col {
            width: 100px;
        }
        
        .leakage-col {
            width: 80px;
        }
        
        .urge-col {
            width: 60px;
        }
        
        .activity-col {
            width: 120px;
        }
        
        input[type="text"], textarea {
            width: 100%;
            border: none;
            background: transparent;
            font-size: 11px;
            padding: 2px;
            box-sizing: border-box;
        }
        
        textarea {
            resize: none;
            height: 40px;
        }
        
        .buttons {
            text-align: center;
            margin: 20px 0;
        }
        
        .btn {
            background-color: #2c5aa0;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .btn:hover {
            background-color: #1e3f73;
        }
        
        .btn-secondary {
            background-color: #6c757d;
        }
        
        .btn-secondary:hover {
            background-color: #545b62;
        }
        
        .comments-section {
            margin-top: 20px;
        }
        
        .comments-section textarea {
            width: 100%;
            height: 60px;
            border: 1px solid #ccc;
            padding: 8px;
            border-radius: 4px;
            background: white;
        }
        
        .pads-section {
            margin-top: 10px;
        }
        
        .pads-section input {
            width: 60px;
            padding: 4px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        .legend {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
            font-size: 11px;
        }
        
        .legend h4 {
            margin: 0 0 10px 0;
            color: #2c5aa0;
        }
        
        .legend-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>CMH Physical Therapy</h1>
        <p>Pelvic Health Program</p>
        <p>218-878-7026</p>
        <p>#08914</p>
        <h2>Record of Bowel and Bladder Function</h2>
    </div>

    <div class="form-container">
        <div class="patient-info">
            <div>
                <label>Name: </label>
                <input type="text" id="patientName" placeholder="Enter patient name">
            </div>
            <div>
                <label>Date: </label>
                <input type="date" id="diaryDate">
            </div>
        </div>

        <div class="legend">
            <h4>Reference Guide:</h4>
            <div class="legend-grid">
                <div>
                    <strong>Bristol Stool Types:</strong><br>
                    Type 1: Hard lumps<br>
                    Type 2: Lumpy sausage<br>
                    Type 3: Cracked sausage<br>
                    Type 4: Smooth sausage<br>
                    Type 5: Soft blobs<br>
                    Type 6: Fluffy pieces<br>
                    Type 7: Watery
                </div>
                <div>
                    <strong>Leakage Amounts:</strong><br>
                    Urine: S=Small, M=Medium, L=Large<br>
                    Stool: S=Small stain, P=Pea size, T=1-2 tbsp, C=Complete<br><br>
                    <strong>Urge Levels:</strong><br>
                    1=Mild, 2=Moderate, 3=Strong
                </div>
            </div>
        </div>

        <table>
            <thead>
                <tr>
                    <th class="time-col">Time of Day</th>
                    <th class="food-col">Type & Amount of Food & Fluid Intake</th>
                    <th class="elimination-col">Elimination<br>U = Urinate<br>BM = bowel movement type</th>
                    <th class="leakage-col">Amount of Leakage<br>S/M/L<br>S/P/T/C</th>
                    <th class="urge-col">Was Urge Present<br>1/2/3</th>
                    <th class="activity-col">Activity With Leakage/notes</th>
                </tr>
            </thead>
            <tbody id="diaryTable">
                <!-- Midnight to 11:00 PM rows -->
            </tbody>
        </table>

        <div class="comments-section">
            <label><strong>Comments:</strong></label>
            <textarea id="comments" placeholder="Special problems, medications, or other notes..."></textarea>
        </div>

        <div class="pads-section">
            <label><strong>Number of pads used today:</strong> </label>
            <input type="number" id="padsUsed" min="0" placeholder="0">
        </div>

        <div class="buttons">
            <button class="btn" onclick="saveData()">Save Data</button>
            <button class="btn btn-secondary" onclick="exportToExcel()">Export to Excel</button>
            <button class="btn btn-secondary" onclick="clearForm()">Clear Form</button>
            <button class="btn btn-secondary" onclick="loadSampleData()">Load Sample</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Time slots for the diary
        const timeSlots = [
            'Midnight', '1:00 am', '2:00 am', '3:00 am', '4:00 am', '5:00 am',
            '6:00 am', '7:00 am', '8:00 am', '9:00 am', '10:00 am', '11:00 am',
            'Noon', '1:00 pm', '2:00 pm', '3:00 pm', '4:00 pm', '5:00 pm',
            '6:00 pm', '7:00 pm', '8:00 pm', '9:00 pm', '10:00 pm', '11:00 pm'
        ];

        // Initialize the form
        function initializeForm() {
            const tableBody = document.getElementById('diaryTable');
            
            timeSlots.forEach((time, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="time-col">${time}</td>
                    <td class="food-col">
                        <textarea id="food_${index}" placeholder="Food and drink..."></textarea>
                    </td>
                    <td class="elimination-col">
                        <input type="text" id="elimination_${index}" placeholder="U, BM type 1-7">
                    </td>
                    <td class="leakage-col">
                        <input type="text" id="leakage_${index}" placeholder="S/M/L/P/T/C">
                    </td>
                    <td class="urge-col">
                        <input type="text" id="urge_${index}" placeholder="1/2/3">
                    </td>
                    <td class="activity-col">
                        <textarea id="activity_${index}" placeholder="Activity/notes..."></textarea>
                    </td>
                `;
                tableBody.appendChild(row);
            });

            // Set today's date
            document.getElementById('diaryDate').valueAsDate = new Date();
        }

        // Save data to localStorage
        function saveData() {
            const data = collectFormData();
            const dateKey = `diary_${data.date}_${Date.now()}`;
            localStorage.setItem(dateKey, JSON.stringify(data));
            alert('Data saved successfully!');
        }

        // Collect all form data
        function collectFormData() {
            const data = {
                name: document.getElementById('patientName').value,
                date: document.getElementById('diaryDate').value,
                comments: document.getElementById('comments').value,
                padsUsed: document.getElementById('padsUsed').value,
                entries: []
            };

            timeSlots.forEach((time, index) => {
                const entry = {
                    time: time,
                    food: document.getElementById(`food_${index}`).value,
                    elimination: document.getElementById(`elimination_${index}`).value,
                    leakage: document.getElementById(`leakage_${index}`).value,
                    urge: document.getElementById(`urge_${index}`).value,
                    activity: document.getElementById(`activity_${index}`).value
                };
                data.entries.push(entry);
            });

            return data;
        }

        // Export to Excel
        function exportToExcel() {
            const data = collectFormData();
            
            // Prepare data for Excel
            const excelData = [
                ['CMH Physical Therapy - Bowel and Bladder Function Diary'],
                ['Patient Name:', data.name],
                ['Date:', data.date],
                ['Comments:', data.comments],
                ['Number of pads used:', data.padsUsed],
                [],
                ['Time', 'Food & Fluid Intake', 'Elimination', 'Leakage Amount', 'Urge Present', 'Activity/Notes']
            ];

            data.entries.forEach(entry => {
                excelData.push([
                    entry.time,
                    entry.food,
                    entry.elimination,
                    entry.leakage,
                    entry.urge,
                    entry.activity
                ]);
            });

            // Create workbook and worksheet
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(excelData);
            
            // Set column widths
            ws['!cols'] = [
                { width: 15 }, // Time
                { width: 25 }, // Food
                { width: 15 }, // Elimination
                { width: 12 }, // Leakage
                { width: 10 }, // Urge
                { width: 25 }  // Activity
            ];

            XLSX.utils.book_append_sheet(wb, ws, 'Diary');
            
            // Generate filename
            const filename = `Bowel_Bladder_Diary_${data.name}_${data.date}.xlsx`.replace(/\s+/g, '_');
            
            // Save file
            XLSX.writeFile(wb, filename);
        }

        // Clear form
        function clearForm() {
            if (confirm('Are you sure you want to clear all data?')) {
                document.getElementById('patientName').value = '';
                document.getElementById('comments').value = '';
                document.getElementById('padsUsed').value = '';
                
                timeSlots.forEach((time, index) => {
                    document.getElementById(`food_${index}`).value = '';
                    document.getElementById(`elimination_${index}`).value = '';
                    document.getElementById(`leakage_${index}`).value = '';
                    document.getElementById(`urge_${index}`).value = '';
                    document.getElementById(`activity_${index}`).value = '';
                });
            }
        }

        // Load sample data (based on the example in the PDF)
        function loadSampleData() {
            document.getElementById('patientName').value = 'Sample Patient';
            document.getElementById('comments').value = 'Week before period';
            document.getElementById('padsUsed').value = '3';
            
            // Sample entries from the PDF example
            const sampleEntries = {
                6: { food: 'Woke up at 6:45 am', elimination: 'U', urge: '3' },
                7: { food: 'Coffee, bagel', elimination: 'BM type 4' },
                8: { leakage: 'M', activity: 'Fast walking' },
                9: { food: 'Apple', elimination: 'U BM', leakage: 'P', urge: '2', activity: 'No urge control' },
                11: { elimination: 'U', urge: '1', activity: 'Key in the door' },
                12: { food: 'Tuna sandwich, milk, pear' },
                14: { leakage: 'M', urge: '2' },
                15: { food: 'Tea, cookies', leakage: 'S', activity: 'Running water' },
                18: { food: 'Chicken, corn pudding, salad, apple juice', leakage: 'M', urge: '3' },
                20: { leakage: 'S', urge: '3' },
                22: { food: 'To bed at 10:30', leakage: 'M', urge: '3' }
            };

            Object.entries(sampleEntries).forEach(([index, entry]) => {
                if (entry.food) document.getElementById(`food_${index}`).value = entry.food;
                if (entry.elimination) document.getElementById(`elimination_${index}`).value = entry.elimination;
                if (entry.leakage) document.getElementById(`leakage_${index}`).value = entry.leakage;
                if (entry.urge) document.getElementById(`urge_${index}`).value = entry.urge;
                if (entry.activity) document.getElementById(`activity_${index}`).value = entry.activity;
            });
        }

        // Initialize the form when page loads
        document.addEventListener('DOMContentLoaded', initializeForm);
    </script>
</body>
</html>
